var U=Object.defineProperty;var v=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var w=(t,e,a)=>e in t?U(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,x=(t,e)=>{for(var a in e||(e={}))D.call(e,a)&&w(t,a,e[a]);if(v)for(var a of v(e))F.call(e,a)&&w(t,a,e[a]);return t};import{a as b}from"./index.2885cb15.js";import{r as V,G as O,o as c,e as u,i as s,H as h,J as y,n as g,j as m,K as P,l as B,p as C,q as j,L as A,F as M,M as H,m as I,t as p,T as J}from"./vendor.b08dc4ec.js";import{_ as S}from"./index.86c095c3.js";import{T as K}from"./TwButton.c3ff6f91.js";const z={name:"ProductForm",props:{update:{type:Function},categoriesProp:{type:Array,default:[{id:0,name:"Pilih kategori"}]},productProp:{type:Object,default:{id:0,name:"",spec:"",base_unit:"",base_weight:0,base_price:0,first_stock:0,stock:0,is_active:!0,category_id:0}}},methods:{dropdownShouldOpen(t){return(this.product.category_id!==0||t.search.length!==0)&&t.open},async formSubmit(t){const e=this;t.preventDefault(),e.product.id>0?await e.updateProduct(e.product,e.product.id):await e.insertProduct(e.product)},async insertProduct(t){const e=this,a=x({},t);delete a.id,await b.post("/api/products/",JSON.stringify(a),{headers:{accept:"application/json","Content-Type":"application/json"}}).then(n=>{e.$emit("update",n.data,0)})},async updateProduct(t,e){const a=this,n=x({},t);delete n.id,await b.put(`/api/products/${e}/`,JSON.stringify(n),{headers:{accept:"application/json","Content-Type":"application/json"}}).then(o=>{a.$emit("update",o.data,e)})}},computed:{enableSubmit(){return this.nameValid||this.base_unitValid||this.base_weightValid||this.base_priceValid||this.categoryValid},nameValid(){return this.product.name.trim().length===0},base_unitValid(){return this.product.base_unit.trim().length===0},base_weightValid(){return this.product.base_weight<0},base_priceValid(){return this.product.base_price<=0},categoryValid(){return this.product.category_id===0||this.product.category_id===null},categories:{get(){return this.$props.categoriesProp}},inputNumeral:{get(){return{numeralPositiveOnly:!0,noImmediatePrefix:!0,rawValueTrimPrefix:!0,numeralIntegerScale:9,numeralDecimalScale:2,numeral:!0}}}},directives:{focus:{mounted(t){setTimeout(()=>{t.focus()},100)}}},async mounted(){const t=this;t.categoryId=t.product.category_id},data(){return{product:x({},this.$props.productProp),categoryId:0,searchInput:""}}},r=t=>(C("data-v-589204e0"),t=t(),j(),t),G={class:"flex flex-col md:flex-row gap-x-4"},L={for:"prod-name",class:"flex-label"},q=r(()=>s("span",{class:"flex-span"},"Nama Produk:",-1)),E={for:"prod-spec",class:"flex-label"},R=r(()=>s("span",{class:"flex-span"},"Spek:",-1)),Q={class:"flex flex-col md:flex-row gap-x-4"},W={for:"base-unit",class:"flex-label"},X=r(()=>s("span",{class:"flex-span"},"Unit (terkecil):",-1)),Y={for:"base-weight",class:"flex-label"},Z=r(()=>s("span",{class:"flex-span"},"Berat (terkecil):",-1)),$={class:"flex flex-col md:flex-row gap-x-4"},ee={for:"base-price",class:"flex-label"},te=r(()=>s("span",{class:"flex-span"},"Harga Beli (terkecil):",-1)),se={for:"first-stock",class:"flex-label"},ae=r(()=>s("span",{class:"flex-span"},"Stock awal:",-1)),oe={class:"flex flex-col md:flex-row gap-x-4"},le={for:"stock",class:"flex-label"},ie=r(()=>s("span",{class:"flex-span"},"Sisa Stock:",-1)),ne={for:"category-id",class:"flex-label"},de=r(()=>s("span",{class:"flex-span"},"Kategori:",-1)),re={class:"my-4"},ce={for:"is-active",class:"py-2 flex-1 w-full"},ue=r(()=>s("span",{class:"flex-span ml-2"},"Aktif ?",-1)),pe={for:"is-sale",class:"py-2 flex-1 w-full"},me=r(()=>s("span",{class:"flex-span ml-2"},"Produk untuk dijual",-1)),_e={class:"flex flex-row gap-2 mt-5"},fe=["disabled"];function be(t,e,a,n,o,i){const _=V("v-number"),d=V("v-select"),f=O("focus");return c(),u("div",null,[s("form",{onSubmit:e[10]||(e[10]=(...l)=>i.formSubmit&&i.formSubmit(...l))},[s("div",G,[s("label",L,[q,h(s("input",{maxlength:"50",id:"prod-name",type:"text",class:g(["flex-input",{"input-disable":i.nameValid}]),"onUpdate:modelValue":e[0]||(e[0]=l=>o.product.name=l),placeholder:"e.g. Gula Pasir"},null,2),[[f],[y,o.product.name]])]),s("label",E,[R,h(s("input",{id:"prod-spec",type:"text",maxlength:"50",class:"flex-input","onUpdate:modelValue":e[1]||(e[1]=l=>o.product.spec=l),placeholder:"e.g. 1 zax @ 25kg"},null,512),[[y,o.product.spec]])])]),s("div",Q,[s("label",W,[X,h(s("input",{id:"base-unit",maxlength:"6",type:"text",class:g(["flex-input",{"input-disable":i.base_unitValid}]),"onUpdate:modelValue":e[2]||(e[2]=l=>o.product.base_unit=l),placeholder:"e.g. kg"},null,2),[[y,o.product.base_unit]])]),s("label",Y,[Z,m(_,{id:"base-weight",class:g(["flex-input",{"input-disable":i.base_weightValid}]),options:i.inputNumeral,modelValue:o.product.base_weight,"onUpdate:modelValue":e[3]||(e[3]=l=>o.product.base_weight=l),placeholder:"e.g. 2.5"},null,8,["options","class","modelValue"])])]),s("div",$,[s("label",ee,[te,m(_,{id:"base-price",class:g(["flex-input",{"input-disable":i.base_priceValid}]),options:i.inputNumeral,modelValue:o.product.base_price,"onUpdate:modelValue":e[4]||(e[4]=l=>o.product.base_price=l),placeholder:"e.g. 12,500"},null,8,["options","class","modelValue"])]),s("label",se,[ae,m(_,{id:"first-stock",readonly:"",class:"flex-input-readonly",options:i.inputNumeral,modelValue:o.product.first_stock,"onUpdate:modelValue":e[5]||(e[5]=l=>o.product.first_stock=l)},null,8,["options","modelValue"])])]),s("div",oe,[s("label",le,[ie,m(_,{id:"stock",readonly:"",class:"flex-input-readonly",options:i.inputNumeral,modelValue:o.product.stock,"onUpdate:modelValue":e[6]||(e[6]=l=>o.product.stock=l)},null,8,["options","modelValue"])]),s("label",ne,[de,m(d,{class:g(["flex-select",{"input-disable":i.categoryValid}]),id:"category-id",options:i.categories,label:"name",modelValue:o.product.category_id,"onUpdate:modelValue":e[7]||(e[7]=l=>o.product.category_id=l),placeholder:"Select kategori",reduce:l=>l.id},null,8,["options","modelValue","class","reduce"])])]),s("div",re,[s("label",ce,[h(s("input",{id:"is-active",type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=l=>o.product.is_active=l)},null,512),[[P,o.product.is_active]]),ue]),s("label",pe,[h(s("input",{id:"is-sale",type:"checkbox","onUpdate:modelValue":e[9]||(e[9]=l=>o.product.is_sale=l)},null,512),[[P,o.product.is_sale]]),me])]),s("div",_e,[s("button",{type:"submit",class:"btn-primary",disabled:i.enableSubmit},"Save",8,fe),B(t.$slots,"default",{},void 0,!0)])],32)])}var N=S(z,[["render",be],["__scopeId","data-v-589204e0"]]);Array.prototype.indexOfObject=function(t,e){for(let a=0,n=this.length;a<n;a++)if(this[a][t]===e)return a;return-1};const T={id:0,name:"",spec:"",base_unit:"",base_weight:0,base_price:0,first_stock:0,stock:0,is_active:!0,category_id:0},he={name:"Product",components:{"tw-button":A(K),"product-form":N},methods:{cancelForm(){const t=this;t.selectedId=-1,t.selectedIndex=-1},async deleteForm(){const t=this,e={"Content-Type":"application/json"};await b.delete(`/api/products/${t.selectedId}`,{headers:e}).then(a=>{if(a.status===200){const n=t.products.indexOfObject("id",t.selectedId);t.products.splice(n,1),t.cancelForm()}})},itemClick(t,e){const a=this;a.selectedId=e,a.selectedIndex=t},updateData(t,e){const a=this;let n=a.products;const o=a.products.indexOfObject("id",e);n[o]=t,a.products=n,e===0&&a.products.push(T),a.cancelForm()},async loadCategories(){const t=this,e={"Content-Type":"application/json"};await b.get("/api/categories/",{headers:e}).then(a=>{const n=a.data;t.loadedCategories=n}).catch(a=>{t.loadedCategories=[]})},async loadProducts(){const t=this,e={"Content-Type":"application/json"};await b.get("/api/products/",{headers:e}).then(a=>{const n=a.data;t.products=[...n,T]})}},async mounted(){await this.loadCategories(),await this.loadProducts()},directives:{focus:{mounted(t){setTimeout(()=>{t.focus()},100)}}},computed:{categories(){return this.loadedCategories},formatNumber(){return t=>Intl.NumberFormat("id-ID").format(t)},categoryName(){return t=>{const e=this.loadedCategories.filter(a=>a.id===t)[0];return e?e.name:""}}},data(){return{loadedCategories:[],products:[],selectedIndex:-1,selectedId:-1}}},k=t=>(C("data-v-44aef650"),t=t(),j(),t),ge=k(()=>s("h1",null,"Product",-1)),xe=k(()=>s("div",{class:"message"}," Dalam bisnis, produk adalah barang atau jasa yang dapat diperjualbelikan. Dalam marketing, produk adalah apapun yang bisa ditawarkan ke sebuah pasar dan bisa memuaskan sebuah keinginan atau kebutuhan. Dalam tingkat pengecer, produk sering disebut sebagai merchandise. Dalam manufaktur, produk dibeli dalam bentuk barang mentah dan dijual sebagai barang jadi. Produk yang berupa barang mentah seperti metal atau hasil pertanian sering pula disebut sebagai komoditas. ",-1)),ke={class:"mt-4"},ye=k(()=>s("hr",null,null,-1)),ve={key:0,class:"product-list"},we=k(()=>s("span",{class:"flex-1"},null,-1)),Ve=["disabled"],Pe={key:1,class:"product-list"},Ce=["onClick"],je={key:1,class:"product-item"},Ie={class:"flex-none w-full md:w-2/5"},Se=["onClick"],Ne={class:"text-sm"},Te={class:"flex-1 w-full text-sm mt-2 md:mt-0"};function Ue(t,e,a,n,o,i){const _=N;return c(),u("div",null,[ge,xe,s("div",ke,[ye,(c(!0),u(M,null,H(o.products,(d,f)=>(c(),u("div",{key:d.id},[m(J,{name:"slide-fade"},{default:I(()=>[o.selectedIndex===f&&o.selectedId===d.id?(c(),u("div",ve,[m(_,{productProp:d,categoriesProp:i.categories,onUpdate:i.updateData},{default:I(()=>[s("button",{type:"button",class:"btn-cancel rounded-md",onClick:e[0]||(e[0]=l=>i.cancelForm())}," Cancel "),we,s("button",{onClick:e[1]||(e[1]=l=>i.deleteForm()),type:"button",class:"btn-remove",disabled:d.id===0}," Delete ",8,Ve)]),_:2},1032,["productProp","categoriesProp","onUpdate"])])):(c(),u("div",Pe,[d.id===0?(c(),u("div",{key:0,onClick:l=>i.itemClick(f,d.id),class:"span-link"}," + ",8,Ce)):(c(),u("div",je,[s("div",Ie,[s("div",{onClick:l=>i.itemClick(f,d.id),class:"span-link"},p(d.name),9,Se),s("div",Ne,[s("div",null,"Spek: "+p(d.spec),1),s("div",null,p(d.is_active?"Masih Aktif":"Tidak Aktif"),1),s("div",null,p(d.is_sale?"Produk untuk dijual":"Tidak untuk dijual"),1)])]),s("div",Te,[s("div",null,"Kategori: "+p(i.categoryName(d.category_id)),1),s("div",null,"Berat: "+p(i.formatNumber(d.base_weight))+" kg",1),s("div",null,"Harga: "+p(i.formatNumber(d.base_price)),1),s("div",null,"Unit: "+p(d.base_unit),1)])]))]))]),_:2},1024)]))),128))])])}var Me=S(he,[["render",Ue],["__scopeId","data-v-44aef650"]]);export{Me as default};
