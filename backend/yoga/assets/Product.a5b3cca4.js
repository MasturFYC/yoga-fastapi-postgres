var G=Object.defineProperty;var B=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var M=(t,e,n)=>e in t?G(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,_=(t,e)=>{for(var n in e||(e={}))W.call(e,n)&&M(t,n,e[n]);if(B)for(var n of B(e))Q.call(e,n)&&M(t,n,e[n]);return t};import{T as z}from"./TwIcon.2bacb9f2.js";import{a as g}from"./index.2885cb15.js";import{r as N,G as K,o as c,e as u,j as i,t as f,H as y,J as C,K as l,k as p,L as k,M as T,n as v,m as E,N as U,l as F,q as A,s as O,F as S,O as R,c as $,p as w,P as Y,Q as H,R as X,T as Z}from"./vendor.d21eb4bc.js";import{_ as j}from"./index.38b9c37f.js";import{T as ee}from"./TwButton.6252f860.js";const te={name:"UnitForm",props:{basePrice:{type:Number,default:0},unitProp:{type:Object},addNew:{type:Function}},methods:{onFocus(t){this.iBlur=t},getButtonName(t){this.clickedButton=t.submitter.name},onKeyDown(t){const e=Array.from(t.target.form.parentElement.querySelectorAll("form")),n=e.indexOf(t.target.form),r=e.length-1,d=t.key==="ArrowUp"?n===0?r:n-1:n===r?0:n+1,m=e[d].querySelectorAll("input")[this.getBlurIndex];m.focus(),m.type==="text"&&m.value.length>0&&setTimeout(()=>{m.setSelectionRange(0,m.value.length)},0)},focusNext(t){const e=Array.from(t.target.form.querySelectorAll(["input","button"])),n=e.indexOf(t.target);if(n<6){const d=n===2?n+1:n,s=e[d+1];s.focus(),s.type==="text"&&setTimeout(()=>{s.setSelectionRange(0,s.value.length)},0);return}this.isInvalidPrice||(this.isDirty&&this.formSubmit(t),this.gotoNextRow(t.target.form))},gotoNextRow(t){const e=Array.from(t.parentElement.querySelectorAll("form"));let n=e.indexOf(t);const r=e.length-1;n===r&&(this.$emit("addNew"),n--);const a=e[n+1].querySelectorAll("input")[0];a.focus(),a.value.length>0&&setTimeout(()=>{a.setSelectionRange(0,a.value.length)},0)},setDirty(){this.formChanged=!0},async formSubmit(t){const e=this;t.preventDefault(),!this.isInvalidPrice&&(e.unit.id>0?await e.updateUnit(e.unit,e.unit.id):await e.insertUnit(e.unit))},cancelEdit(){this.unit.id===0?this.$emit("update",this.unit,-1):this.unit=_({},this.oldUnit),this.formChanged=!1,this.isDuplicate=!1},async insertUnit(t){const e=this,n=_({},t);delete n.id,await g.post("/api/units/",JSON.stringify(n),{headers:{accept:"application/json","Content-Type":"application/json"}}).then(r=>{e.$emit("update",r.data,0),e.oldUnit=r.data,e.formChanged=!1,e.isDuplicate=!1,e.unit=r.data}).catch(r=>{e.isDuplicate=!0})},async updateUnit(t,e){const n=this,r=_({},t);delete r.id,await g.put(`/api/units/${e}/`,JSON.stringify(r),{headers:{accept:"application/json","Content-Type":"application/json"}}).then(d=>{n.$emit("update",d.data,e),this.oldUnit=d.data,this.formChanged=!1,n.isDuplicate=!1}).catch(d=>{this.isDuplicate=!0})}},data(){return{iBlur:0,isDuplicate:!1,clickedButton:null,formChanged:!1,oldUnit:_({},this.$props.unitProp),unit:_({},this.$props.unitProp)}},computed:{salePrice:{get(){return this.unit.price},set(t){t!==this.unit.price&&(this.formChanged=!0,this.unit.price=t,this.unit.margin=(this.unit.price-this.buyPrice)/this.buyPrice*100)}},unitName:{get(){return this.unit.name},set(t){t!==this.unit.name&&(this.formChanged=!0,this.unit.name=t)}},barcode:{get(){return this.unit.barcode},set(t){t!==this.unit.barcode&&(this.formChanged=!0,this.unit.barcode=t)}},unitContent:{get(){return this.unit.content},set(t){t!==this.unit.content&&(this.formChanged=!0,this.unit.content=t,this.unit.price=this.buyPrice+this.buyPrice*this.margin)}},unitMargin:{get(){return this.unit.margin},set(t){t!==this.unit.margin&&(this.formChanged=!0,this.unit.margin=t,this.unit.price=this.buyPrice+this.buyPrice*this.margin)}},unitDefault:{get(){return this.unit.is_default},set(t){t!==this.unit.is_default&&(this.formChanged=!0,this.unit.is_default=t)}},isInvalidPrice(){return this.unit.price<this.buyPrice},getBlurIndex(){return this.iBlur},isDirty(){return this.formChanged},inputNumber:{get(){return{decimal:",",separator:".",suffix:"",precision:2,masked:!1}}},inputPercent:{get(){return{decimal:",",separator:".",suffix:" %",precision:2,masked:!1}}},buyPrice(){return this.unit.content*this.$props.basePrice},margin(){return this.unit.margin/100}},directives:{focus:{mounted:function(t){setTimeout(()=>{t.focus()},0)}}}},P=t=>(A("data-v-16520b71"),t=t(),O(),t),se=["id"],ie={class:"flex w-full md:w-[120px] px-0 md:px-1 border-0 md:border md:border-indigo-200 md:border-t-0"},oe=P(()=>i("span",{class:"label-title self-center"},"ID#:",-1)),ne={class:"my-input self-center text-gray-400"},re={class:"flex w-full md:w-[200px] px-0 md:px-1 border-0 md:border md:border-indigo-200 md:border-l-0 md:border-t-0"},de=P(()=>i("span",{class:"label-title"},"Unit",-1)),ae={class:"flex w-full md:w-[300px] px-0 md:px-1 border-0 md:border md:border-indigo-200 md:border-l-0 md:border-t-0"},le=P(()=>i("span",{class:"label-title"},"Barcode",-1)),ce={class:"flex w-full md:w-[120px] px-0 md:px-1 border-0 md:border md:border-indigo-200 md:border-l-0 md:border-t-0"},ue=P(()=>i("span",{class:"label-title"},"Isi",-1)),pe={class:"flex w-full md:w-[250px] px-0 md:px-1 border-0 md:border md:border-indigo-200 md:border-l-0 md:border-t-0"},me=P(()=>i("span",{class:"label-title"},"Harga Beli",-1)),fe={class:"flex w-full md:w-[160px] px-0 md:px-1 border-0 md:border md:border-indigo-200 md:border-l-0 md:border-t-0"},he=P(()=>i("span",{class:"label-title"},"Margin",-1)),be={class:"flex w-full md:w-[250px] px-0 md:px-1 border-0 md:border md:border-indigo-200 md:border-l-0 md:border-t-0"},_e=P(()=>i("span",{class:"label-title"},"Harga Jual",-1)),ge={class:"flex w-full md:w-[225px] px-0 md:px-1 border-0 mt-2 md:mt-0 md:border md:border-indigo-200 md:border-l-0 md:border-t-0"},xe=P(()=>i("span",{class:"px-1 md:hidden self-center text-gray-500"},"Default ?",-1)),ye=["disabled"],ve=["disabled"],we={key:0,class:"border-0 text-sm md:border md:border-indigo-200 p-2 text-red-700 flex-none w-full md:border-t-0"},ke={key:1,class:"border-0 text-sm md:border md:border-indigo-200 p-2 text-red-700 flex-none w-full md:border-t-0"};function Pe(t,e,n,r,d,s){const a=N("number"),m=z,h=K("focus");return c(),u("form",{onSubmit:e[20]||(e[20]=l((...o)=>s.getButtonName&&s.getButtonName(...o),["prevent","stop"])),id:"myform-"+d.unit.id},[i("div",{class:"text-[13px] w-full flex flex-col gap-x-0 md:flex-row py-4 md:py-0 gap-y-1 md:gap-y-0",onKeydown:[e[16]||(e[16]=U(l((...o)=>s.focusNext&&s.focusNext(...o),["prevent","stop"]),["enter"])),e[17]||(e[17]=U(l((...o)=>s.onKeyDown&&s.onKeyDown(...o),["prevent","stop"]),["down"])),e[18]||(e[18]=U(l((...o)=>s.onKeyDown&&s.onKeyDown(...o),["prevent","stop"]),["up"])),e[19]||(e[19]=U(l((...o)=>s.cancelEdit&&s.cancelEdit(...o),["prevent","stop"]),["esc"]))]},[i("div",ie,[oe,i("span",ne,f(d.unit.id),1)]),i("label",re,[de,y(i("input",{class:"my-input",type:"text","onUpdate:modelValue":e[0]||(e[0]=o=>s.unitName=o),onFocus:e[1]||(e[1]=l(o=>s.onFocus(0),["prevent","stop"])),maxlength:"6"},null,544),[[h],[C,s.unitName,void 0,{lazy:!0}]])]),i("label",ae,[le,y(i("input",{class:"my-input",type:"text","onUpdate:modelValue":e[2]||(e[2]=o=>s.barcode=o),onFocus:e[3]||(e[3]=l(o=>s.onFocus(1),["prevent","stop"])),maxlength:"25"},null,544),[[C,s.barcode,void 0,{lazy:!0}]])]),i("label",ce,[ue,p(a,k({ref:"contentEl",class:"my-input text-left md:text-right",modelValue:s.unitContent,"onUpdate:modelValue":e[4]||(e[4]=o=>s.unitContent=o),modelModifiers:{lazy:!0},onFocus:e[5]||(e[5]=l(o=>s.onFocus(2),["prevent","stop"]))},s.inputNumber,{placeholder:"0"}),null,16,["modelValue"])]),i("label",pe,[me,p(a,k({class:"my-input text-left text-gray-400 md:text-right",modelValue:s.buyPrice,"onUpdate:modelValue":e[6]||(e[6]=o=>s.buyPrice=o),onFocus:e[7]||(e[7]=l(o=>s.onFocus(3),["prevent","stop"]))},s.inputNumber,{placeholder:"0",readonly:""}),null,16,["modelValue"])]),i("label",fe,[he,p(a,k({class:"my-input text-left md:text-right",modelValue:s.unitMargin,"onUpdate:modelValue":e[8]||(e[8]=o=>s.unitMargin=o),modelModifiers:{lazy:!0},onFocus:e[9]||(e[9]=l(o=>s.onFocus(4),["prevent","stop"]))},s.inputPercent,{placeholder:"0"}),null,16,["modelValue"])]),i("label",be,[_e,p(a,k({class:"my-input text-left md:text-right",modelValue:s.salePrice,"onUpdate:modelValue":e[10]||(e[10]=o=>s.salePrice=o),modelModifiers:{lazy:!0},onFocus:e[11]||(e[11]=l(o=>s.onFocus(5),["prevent","stop"]))},s.inputNumber,{placeholder:"0"}),null,16,["modelValue"])]),i("label",ge,[y(i("input",{type:"checkbox","onUpdate:modelValue":e[12]||(e[12]=o=>s.unitDefault=o),class:"mx-0 md:mx-auto self-center",onFocus:e[13]||(e[13]=l(o=>s.onFocus(6),["prevent","stop"]))},null,544),[[T,s.unitDefault,void 0,{lazy:!0}]]),xe]),i("div",{class:v(["flex flex-row w-[270px] gap-x-0 py-1 px-0 mt-4 md:mt-0 md:px-1 border-0 md:border md:border-indigo-200 md:border-l-0 md:border-t-0",{"bg-green-100":s.isDirty}])},[i("button",{type:"button",onClick:e[14]||(e[14]=l((...o)=>s.formSubmit&&s.formSubmit(...o),["prevent","stop"])),disabled:!s.isDirty,class:v(["btn border-transparent rounded-sm hover:bg-gray-200",{"disabled hover:bg-transparent":!s.isDirty}])},[p(m,{name:"mdi:check",class:v(["flex-1 icon w-5 h-5 text-gray-400 group-hover:text-gray-500",{"text-green-700":s.isDirty}])},null,8,["class"])],10,ye),i("button",{type:"button",disabled:!s.isDirty&&d.unit.id!==0,onClick:e[15]||(e[15]=l((...o)=>s.cancelEdit&&s.cancelEdit(...o),["prevent","stop"])),class:v(["btn border-transparent rounded-sm hover:bg-gray-200",{"disabled hover:bg-transparent":!s.isDirty}])},[p(m,{name:"mdi-light:cancel",class:v(["icon w-5 h-5 text-gray-400 group-hover:text-gray-500",{"text-orange-700":s.isDirty||d.unit.id===0}])},null,8,["class"])],10,ve),E(t.$slots,"default",{},void 0,!0)],2)],32),s.isInvalidPrice?(c(),u("div",we," Harga jual tidak boleh lebih kecil dari harga beli. ")):F("",!0),d.isDuplicate?(c(),u("div",ke," Nama unit atau barcode sudah digunakan. ")):F("",!0)],40,se)}var J=j(te,[["render",Pe],["__scopeId","data-v-16520b71"]]);Array.prototype.indexOfObject=function(t,e){for(let n=0,r=this.length;n<r;n++)if(this[n][t]===e)return n;return-1};const Ce={name:"UnitList",props:{productId:{type:Number,default:0},update:{type:Function},productPrice:{type:Number,default:0}},components:{"unit-form":J},methods:{async removeUnit(t){const e=this,n={"Content-Type":"application/json"};await g.delete(`/api/units/${t}`,{headers:n}).then(r=>{if(r.status===200){const d=e.units.indexOfObject("id",t);e.units.splice(d,1)}})},updateUnit(t,e){const n=this;n.units;const r=n.units.indexOfObject("id",e);e===-1?t.id===0&&n.units.splice(r,1):(n.units.splice(r,1,_({},t)),e===0&&setTimeout(()=>{n.addUnit()},0))},addUnit(){this.units.indexOfObject("id",0)<0&&this.units.push({id:0,name:"",barcode:"",content:1,is_default:!1,product_id:this.$props.productId,buy_price:this.$props.productPrice,margin:30,price:this.$props.productPrice+this.$props.productPrice*(30/100)})},async loadUnits(){const t=this;await g.get(`/api/units/product/${t.$props.productId}`,{headers:{accept:"application/json","Content-Type":"application/json"}}).then(e=>{e.status===200&&(t.units=[...e.data])}).catch(e=>{t.units=[]})}},async mounted(){await this.loadUnits()},data(){return{units:[]}}},Ie=Y('<div class="mt-4 hidden text-[13px] w-full flex-row gap-x-0 font-medium md:flex bg-indigo-100"><div class="w-[120px] px-1 py-1 border border-indigo-200">ID#</div><div class="w-[200px] px-1 py-1 border border-indigo-200 border-l-0">NAMA</div><div class="w-[300px] px-1 py-1 border border-indigo-200 border-l-0">BARCODE</div><div class="w-[120px] px-1 py-1 border border-indigo-200 border-l-0 text-right"> ISI </div><div class="w-[250px] px-1 py-1 border border-indigo-200 border-l-0 text-right"> HARGA BELI </div><div class="w-[160px] px-1 py-1 border border-indigo-200 border-l-0 text-right"> MARGIN </div><div class="w-[250px] px-1 py-1 border border-indigo-200 border-l-0 text-right"> HARGA JUAL </div><div class="w-[225px] px-1 py-1 border border-indigo-200 border-l-0 text-center"> DEFAULT </div><div class="w-[270px] px-1 py-1 border border-indigo-200 border-l-0">COMMAND</div></div>',1),Ve={ref:"test"},Ue=["disabled","onClick"];function Ne(t,e,n,r,d,s){const a=z,m=J;return c(),u(S,null,[Ie,i("div",Ve,[(c(!0),u(S,null,R(d.units,h=>(c(),$(m,{key:h.id,unitProp:_({},h),basePrice:t.$props.productPrice,onUpdate:s.updateUnit,onAddNew:s.addUnit},{default:w(()=>[i("button",{class:"btn border-transparent rounded-sm hover:bg-gray-200",type:"button",tabindex:"-1",disabled:h.id===0,onClick:l(o=>s.removeUnit(h.id),["prevent","stop"])},[p(a,{name:"mdi-light:delete",class:v(["icon w-5 h-5 text-gray-400 group-hover:text-gray-500",{"text-red-700":h.id>0}])},null,8,["class"])],8,Ue)]),_:2},1032,["unitProp","basePrice","onUpdate","onAddNew"]))),128))],512),i("a",{href:"#",onClick:e[0]||(e[0]=l((...h)=>s.addUnit&&s.addUnit(...h),["prevent","stop"]))},"+")],64)}var L=j(Ce,[["render",Ne]]);const Se={name:"ProductForm",props:{update:{type:Function},categoriesProp:{type:Array,default:[{id:0,name:"Pilih kategori"}]},productProp:{type:Object,default:{id:0,name:"",spec:"",base_unit:"",base_weight:0,base_price:0,first_stock:0,stock:0,is_active:!0,category_id:0}}},methods:{dropdownShouldOpen(t){return(this.productCategoryId!==0||t.search.length!==0)&&t.open},async formSubmit(t){const e=this;t.preventDefault(),e.productId>0?await e.updateProduct(e.product,e.productId):await e.insertProduct(e.product)},async insertProduct(t){const e=this,n=_({},t);delete n.id,await g.post("/api/products/",JSON.stringify(n),{headers:{accept:"application/json","Content-Type":"application/json"}}).then(r=>{e.$emit("update",r.data,0)})},async updateProduct(t,e){const n=this,r=_({},t);delete r.id,await g.put(`/api/products/${e}/`,JSON.stringify(r),{headers:{accept:"application/json","Content-Type":"application/json"}}).then(d=>{n.$emit("update",d.data,e)})}},computed:{productId(){return this.product.id},productName:{get(){return this.product.name},set(t){t!==this.product.name&&(this.product.name=t)}},productSpec:{get(){return this.product.spec},set(t){t!==this.product.spec&&(this.product.spec=t)}},baseWeight:{get(){return this.product.base_weight},set(t){t!==this.product.base_weight&&(this.product.base_weight=t)}},basePrice:{get(){return this.product.base_price},set(t){t!==this.product.base_price&&(this.product.base_price=t)}},baseUnit:{get(){return this.product.base_unit},set(t){t!==this.product.base_unit&&(this.product.base_unit=t)}},firstStock:{get(){return this.product.first_stock},set(t){t!==this.product.first_stock&&(this.product.first_stock=t)}},productStock:{get(){return this.product.stock},set(t){t!==this.product.stock&&(this.product.stock=t)}},productCategoryId:{get(){return this.product.category_id},set(t){t!==this.product.category_id&&(this.product.category_id=t===null?0:t)}},enableSubmit(){return this.nameValid||this.base_unitValid||this.base_weightValid||this.base_priceValid||this.categoryValid},nameValid(){return this.product.name.trim().length===0},base_unitValid(){return this.product.base_unit.trim().length===0},base_weightValid(){return this.product.base_weight<0},base_priceValid(){return this.product.base_price<=0},categoryValid(){return this.product.category_id===0||this.product.category_id===null},categories:{get(){return this.$props.categoriesProp}},inputNumeral:{get(){return{decimal:",",separator:".",suffix:"",precision:2,masked:!1}}}},directives:{focus:{mounted(t){setTimeout(()=>{t.focus()},100)}}},async mounted(){const t=this;t.categoryId=t.productCategoryId},data(){return{product:_({},this.$props.productProp),categoryId:0,searchInput:""}}},x=t=>(A("data-v-357f3bbb"),t=t(),O(),t),je={class:"flex flex-col md:flex-row gap-x-4"},De={class:"flex-label"},Te=x(()=>i("span",{class:"flex-span"},"Nama Produk:",-1)),Fe={class:"flex-label"},Ae=x(()=>i("span",{class:"flex-span"},"Spek:",-1)),Oe={class:"flex flex-col md:flex-row gap-x-4"},Be={class:"flex-label"},Me=x(()=>i("span",{class:"flex-span"},"Unit (terkecil):",-1)),ze={class:"flex-label"},Ke=x(()=>i("span",{class:"flex-span"},"Berat (terkecil):",-1)),Ee={class:"flex flex-col md:flex-row gap-x-4"},Re={class:"flex-label"},$e=x(()=>i("span",{class:"flex-span"},"Harga Beli (terkecil):",-1)),He={class:"flex-label"},Je=x(()=>i("span",{class:"flex-span"},"Stock awal:",-1)),Le={class:"flex flex-col md:flex-row gap-x-4"},qe={class:"flex-label"},Ge=x(()=>i("span",{class:"flex-span"},"Sisa Stock:",-1)),We={class:"flex-label"},Qe=x(()=>i("span",{class:"flex-span"},"Kategori:",-1)),Ye=x(()=>i("li",{style:{"text-align":"center"}},"Pilih kategori",-1)),Xe={style:{color:"#555",display:"flex","align-items":"baseline",margin:"0px"}},Ze={class:"font-medium font-[13px]"},et={class:"font-bold"},tt=H(" Kategori tidak ditemukan "),st=H(". "),it={key:1,style:{opacity:"0.5"}},ot={class:"my-4"},nt={class:"py-2 flex-1 w-full mr-4"},rt=x(()=>i("span",{class:"flex-span ml-2"},"Aktif ?",-1)),dt={class:"py-2 flex-1 w-full"},at=x(()=>i("span",{class:"flex-span ml-2"},"Produk untuk dijual",-1)),lt={class:"flex flex-row gap-2 mt-5"},ct=["disabled"];function ut(t,e,n,r,d,s){const a=N("number"),m=N("v-select"),h=K("focus");return c(),u("div",null,[i("form",{onSubmit:e[10]||(e[10]=(...o)=>s.formSubmit&&s.formSubmit(...o))},[i("div",je,[i("label",De,[Te,y(i("input",{maxlength:"50",type:"text",class:v(["flex-input",{"input-disable":s.nameValid}]),"onUpdate:modelValue":e[0]||(e[0]=o=>s.productName=o),placeholder:"e.g. Gula Pasir"},null,2),[[h],[C,s.productName,void 0,{lazy:!0}]])]),i("label",Fe,[Ae,y(i("input",{type:"text",maxlength:"50",class:"flex-input","onUpdate:modelValue":e[1]||(e[1]=o=>s.productSpec=o),placeholder:"e.g. 1 zax @ 25kg"},null,512),[[C,s.productSpec,void 0,{lazy:!0}]])])]),i("div",Oe,[i("label",Be,[Me,y(i("input",{maxlength:"6",type:"text",class:v(["flex-input",{"input-disable":s.base_unitValid}]),"onUpdate:modelValue":e[2]||(e[2]=o=>s.baseUnit=o),placeholder:"e.g. kg"},null,2),[[C,s.baseUnit,void 0,{lazy:!0}]])]),i("label",ze,[Ke,p(a,k({class:"flex-input"},s.inputNumeral,{class:{"input-disable":s.base_weightValid},modelValue:s.baseWeight,"onUpdate:modelValue":e[3]||(e[3]=o=>s.baseWeight=o),modelModifiers:{lazy:!0},placeholder:"e.g. 2.5"}),null,16,["class","modelValue"])])]),i("div",Ee,[i("label",Re,[$e,p(a,k({class:"flex-input"},s.inputNumeral,{class:{"input-disable":s.base_priceValid},modelValue:s.basePrice,"onUpdate:modelValue":e[4]||(e[4]=o=>s.basePrice=o),modelModifiers:{lazy:!0},placeholder:"e.g. 12,500"}),null,16,["class","modelValue"])]),i("label",He,[Je,p(a,k({readonly:"",class:"flex-input-readonly"},s.inputNumeral,{placeholder:"0",modelValue:s.firstStock,"onUpdate:modelValue":e[5]||(e[5]=o=>s.firstStock=o),modelModifiers:{lazy:!0}}),null,16,["modelValue"])])]),i("div",Le,[i("label",qe,[Ge,p(a,k({placeholder:"0",readonly:"",class:"flex-input-readonly"},s.inputNumeral,{modelValue:s.productStock,"onUpdate:modelValue":e[6]||(e[6]=o=>s.productStock=o),modelModifiers:{lazy:!0}}),null,16,["modelValue"])]),i("label",We,[Qe,p(m,{class:v(["style-chooser",{"input-disable":s.categoryValid}]),options:s.categories,label:"name",modelValue:s.productCategoryId,"onUpdate:modelValue":e[7]||(e[7]=o=>s.productCategoryId=o),modelModifiers:{lazy:!0},reduce:o=>o.id},{"list-header":w(()=>[Ye]),"selected-option":w(({name:o})=>[i("div",Xe,[i("span",Ze,f(o),1)])]),selection:w(({item:o})=>[i("span",et,f(o),1)]),option:w(({name:o})=>[i("span",null,f(o),1)]),"no-options":w(({search:o,searching:I})=>[I?(c(),u(S,{key:0},[tt,i("em",null,f(o),1),st],64)):(c(),u("em",it,"Ketikkan untuk mulai mencari kategori."))]),_:1},8,["options","modelValue","class","reduce"])])]),i("div",ot,[i("label",nt,[y(i("input",{type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=o=>d.product.is_active=o)},null,512),[[T,d.product.is_active,void 0,{lazy:!0}]]),rt]),i("label",dt,[y(i("input",{type:"checkbox","onUpdate:modelValue":e[9]||(e[9]=o=>d.product.is_sale=o)},null,512),[[T,d.product.is_sale,void 0,{lazy:!0}]]),at])]),i("div",lt,[i("button",{type:"submit",class:"btn-primary",disabled:s.enableSubmit},"Save",8,ct),E(t.$slots,"default",{},void 0,!0)])],32)])}var q=j(Se,[["render",ut],["__scopeId","data-v-357f3bbb"]]);Array.prototype.indexOfObject=function(t,e){for(let n=0,r=this.length;n<r;n++)if(this[n][t]===e)return n;return-1};const D={id:0,name:"",spec:"",base_unit:"",base_weight:0,base_price:0,first_stock:0,stock:0,is_active:!0,category_id:0},pt={name:"Product",components:{"tw-button":X(ee),"product-form":q,"unit-list":L},methods:{async searchProduct(t){const e=this;if(e.searchText.length>2){const n={"Content-Type":"application/json"};await g.get(`/api/products/search/${e.searchText}/`,{headers:n}).then(r=>{const d=r.data;e.products=[...d,D]})}},unitChecked(t,e){let n=this.units.indexOf(e);t?n<0&&this.units.push(e):n>=0&&this.units.splice(n,1)},cancelForm(){const t=this;t.selectedId=-1,t.selectedIndex=-1},async deleteForm(){const t=this,e={"Content-Type":"application/json"};await g.delete(`/api/products/${t.selectedId}`,{headers:e}).then(n=>{if(n.status===200){const r=t.products.indexOfObject("id",t.selectedId);t.products.splice(r,1),t.cancelForm()}})},itemClick(t,e){const n=this;n.selectedId=e,n.selectedIndex=t},updateData(t,e){const n=this;let r=n.products;const d=n.products.indexOfObject("id",e);r[d]=t,n.products=r,e===0&&n.products.push(D),n.cancelForm()},async loadCategories(){const t=this,e={"Content-Type":"application/json"};await g.get("/api/categories/",{headers:e}).then(n=>{const r=n.data;t.loadedCategories=r}).catch(n=>{t.loadedCategories=[]})},async loadProducts(){const t=this,e={"Content-Type":"application/json"};await g.get("/api/products/",{headers:e}).then(n=>{const r=n.data;t.products=[...r,D]})},async loadProductsByCategory(){const t=this,e={"Content-Type":"application/json"};await g.get(`/api/products/category/${this.categoryId}/`,{headers:e}).then(n=>{const r=n.data;t.products=[...r,D]})}},async mounted(){await this.loadCategories(),await this.loadProducts()},directives:{focus:{mounted(t){setTimeout(()=>{t.focus()},100)}}},computed:{categories(){return this.loadedCategories},formatNumber(){return t=>Intl.NumberFormat("id-ID").format(t)},categoryId:{get:function(){return this.catId},set:function(t){this.catId!==t&&(this.catId=t===null?0:t,this.loadProductsByCategory())}},categoryName(){return t=>{const e=this.loadedCategories.filter(n=>n.id===t)[0];return e?e.name:""}}},data(){return{loadedCategories:[],products:[],units:[],selectedIndex:-1,selectedId:-1,searchText:"",catId:0}}},b=t=>(A("data-v-3e3bb2ae"),t=t(),O(),t),mt=b(()=>i("h1",null,"Product",-1)),ft=b(()=>i("div",{class:"message"}," Dalam bisnis, produk adalah barang atau jasa yang dapat diperjualbelikan. Dalam marketing, produk adalah apapun yang bisa ditawarkan ke sebuah pasar dan bisa memuaskan sebuah keinginan atau kebutuhan. Dalam tingkat pengecer, produk sering disebut sebagai merchandise. Dalam manufaktur, produk dibeli dalam bentuk barang mentah dan dijual sebagai barang jadi. Produk yang berupa barang mentah seperti metal atau hasil pertanian sering pula disebut sebagai komoditas. ",-1)),ht={class:"flex flex-row justify-center items-center mt-4 gap-x-4"},bt={style:{color:"#555",display:"flex","align-items":"baseline",margin:"0px"}},_t={class:"font-medium font-[13px]"},gt={class:"mt-4"},xt=b(()=>i("hr",null,null,-1)),yt={key:0,class:"product-list"},vt=b(()=>i("span",{class:"flex-1"},null,-1)),wt=["disabled"],kt={key:1,class:"product-list"},Pt=["onClick"],Ct={key:1,class:"product-item text-sm"},It={class:"flex-none w-full flex-col md:w-2/5"},Vt=["onClick"],Ut={class:"w-full flex flex-row"},Nt=b(()=>i("div",{class:"w-1/3 text-gray-400"},"Spek:",-1)),St={class:"flex-1"},jt={class:"flex-1"},Dt=["checked","onChange"],Tt=b(()=>i("span",{class:"ml-2"},"Lihat units",-1)),Ft={class:"flex-1 flex flex-col mt-0"},At={class:"flex-1 flex flex-row"},Ot=b(()=>i("div",{class:"w-1/3 text-gray-400"},"Kategori:",-1)),Bt={class:"flex-1"},Mt={class:"flex-1 flex flex-row"},zt=b(()=>i("div",{class:"w-1/3 text-gray-400"},"Berat:",-1)),Kt={class:"flex-1"},Et={class:"flex-1 flex flex-row"},Rt=b(()=>i("div",{class:"w-1/3 text-gray-400"},"Aktif ?",-1)),$t={class:"flex-1"},Ht={class:"flex-1 flex flex-col mt-0"},Jt={class:"flex-1 flex flex-row"},Lt=b(()=>i("div",{class:"w-1/3 text-gray-400"},"Harga:",-1)),qt={class:"flex-1"},Gt={class:"flex-1 flex flex-row"},Wt=b(()=>i("div",{class:"w-1/3 text-gray-400"},"Unit:",-1)),Qt={class:"flex-1"},Yt={class:"flex-1"},Xt=b(()=>i("hr",null,null,-1));function Zt(t,e,n,r,d,s){const a=N("v-select"),m=q,h=L;return c(),u("div",null,[mt,ft,i("div",ht,[p(a,{class:"flex-1 w-1/2 style-chooser",options:[{id:0,name:"All..."},...s.categories],label:"name",modelValue:s.categoryId,"onUpdate:modelValue":e[0]||(e[0]=o=>s.categoryId=o),reduce:o=>o.id},{"selected-option":w(({name:o})=>[i("div",bt,[i("span",_t,f(o),1)])]),_:1},8,["options","modelValue","reduce"]),y(i("input",{type:"text",class:"flex-1 w-1/2 border border-indigo-600 py-1 px-4 text-sm md:w-80 rounded-md placeholder:italic focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500",placeholder:"Search for product name",onKeydown:e[1]||(e[1]=U(l((...o)=>s.searchProduct&&s.searchProduct(...o),["prevent","stop"]),["enter"])),maxlength:"50","onUpdate:modelValue":e[2]||(e[2]=o=>d.searchText=o)},null,544),[[C,d.searchText]])]),i("div",gt,[xt,(c(!0),u(S,null,R(d.products,(o,I)=>(c(),u("div",{key:o.id},[p(Z,{name:"slide-fade"},{default:w(()=>[d.selectedIndex===I&&d.selectedId===o.id?(c(),u("div",yt,[p(m,{productProp:o,categoriesProp:s.categories,onUpdate:s.updateData},{default:w(()=>[i("button",{type:"button",class:"btn-cancel rounded-md",onClick:e[3]||(e[3]=V=>s.cancelForm())}," Cancel "),vt,i("button",{onClick:e[4]||(e[4]=V=>s.deleteForm()),type:"button",class:"btn-remove",disabled:o.id===0}," Delete ",8,wt)]),_:2},1032,["productProp","categoriesProp","onUpdate"])])):(c(),u("div",kt,[o.id===0?(c(),u("a",{key:0,href:"#",onClick:l(V=>s.itemClick(I,o.id),["prevent","stop"]),class:"span-link"},"+",8,Pt)):(c(),u("div",Ct,[i("div",It,[i("a",{href:"#",onClick:l(V=>s.itemClick(I,o.id),["prevent","stop"]),class:"span-link flex-1"},f(o.name),9,Vt),i("div",Ut,[Nt,i("div",St,f(o.spec),1)]),i("div",jt,[i("label",null,[i("input",{type:"checkbox",checked:d.units.includes(o.id),onChange:V=>s.unitChecked(V.target.checked,o.id)},null,40,Dt),Tt])])]),i("div",Ft,[i("div",At,[Ot,i("div",Bt,f(s.categoryName(o.category_id)),1)]),i("div",Mt,[zt,i("div",Kt,f(s.formatNumber(o.base_weight))+" kg",1)]),i("div",Et,[Rt,i("div",$t,f(o.is_active?"Ya":"Tidak"),1)])]),i("div",Ht,[i("div",Jt,[Lt,i("div",qt,f(s.formatNumber(o.base_price)),1)]),i("div",Gt,[Wt,i("div",Qt,f(o.base_unit),1)]),i("div",Yt,f(o.is_sale?"Produk ini untuk dijual":"Tidak untuk dijual"),1)])])),d.units.includes(o.id)?(c(),$(h,{productId:o.id,productPrice:o.base_price,key:o.id},null,8,["productId","productPrice"])):F("",!0)]))]),_:2},1024),Xt]))),128))])])}var rs=j(pt,[["render",Zt],["__scopeId","data-v-3e3bb2ae"]]);export{rs as default};
